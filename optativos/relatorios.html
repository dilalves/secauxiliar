<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/x-icon" href="https://www.curso-objetivo.br/assets/img/favicon.ico" />
  <title>Controle de Sala • Relatórios</title>

  <!-- Materialize -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Ícones -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <style>
    :root {
      --bg:#f7f8fb;
      --card:#ffffff;
      --line:#e9edf3;
      --ink:#0f172a;
      --muted:#6b7280;
      --primary:#0b3b78;
      --accent:#2563eb;
      --radius:14px;
    }

    body{
      background:var(--bg);
      font-family:system-ui, Arial;
      padding:24px;
    }

    /* ===== Topbar igual painel/login ===== */
    header.topbar{
      position:fixed; top:0; left:0; right:0; height:64px;
      background:var(--primary); color:#fff;
      display:flex; align-items:center; z-index:10;
      padding:0 24px;
      box-shadow:0 2px 10px rgba(16,24,40,.12);
    }
    header.topbar .brand{
      display:flex; align-items:center; gap:12px;
      min-width: 0;
    }
    header.topbar h5{
      margin:0; font-weight:600;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      font-size:1.1rem;
    }
    header.topbar .right-actions{
      margin-left:auto;
      display:flex; align-items:center; gap:10px;
    }
    .btn-logout{
      border-radius:999px;
      background: rgba(255,255,255,.15);
      box-shadow:none;
    }
    .btn-logout:hover{ background: rgba(255,255,255,.22); }

    /* ===== Layout ===== */
    .wrap{
      max-width: 720px;
      margin:96px auto 0; /* por causa da topbar fixa */
    }

    .panel-card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:0 10px 30px rgba(0,0,0,.06);
      border:1px solid var(--line);
      overflow:hidden;
    }

    .panel-head{
      padding:18px 18px 0;
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .panel-head .title{
      margin:0;
      font-weight:800;
      color:#111827;
      font-size:1.15rem;
    }
    .panel-head .sub{
      margin:2px 0 0;
      color:var(--muted);
      font-size:.95rem;
      line-height:1.35;
    }

    .panel-body{ padding: 14px 18px 18px; }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    .btn-wide{
      border-radius: 12px;
      box-shadow:none;
      text-transform:none;
      font-weight:700;
    }

    /* mobile */
    @media (max-width: 600px){
      body{ padding:16px; }
      header.topbar{ padding:0 14px; }
      .wrap{ margin-top:86px; }
      .btn-wide{ width:100%; }
    }
  </style>
</head>

<body>

  <!-- Topo (igual painel) -->
  <header class="topbar">
    <div class="brand">
      <img src="/optativos/logo-mini.png" alt="Logo" style="height:28px;">
      <h5>Curso Optativo - Controle de Salas</h5>
    </div>

    <div class="right-actions">
      <a class="btn btn-small btn-logout white-text" href="https://apisec.secauxiliar.com.br/optativo/logout.php">
        <i class="material-icons left">logout</i>Sair
      </a>
    </div>
  </header>

  <div class="wrap">

    <div class="panel-card">
      <div class="panel-head">
        <i class="material-icons" style="color:var(--primary); margin-top:2px;">print</i>
        <div>
          <p class="title">Relatórios</p>
          <p class="sub">Escolha o curso e abra o relatório para imprimir / salvar em PDF.</p>
        </div>
      </div>

      <div class="panel-body">

        <div class="input-field" style="margin-top:12px;">
          <select id="curso">
            <option value="" disabled selected>Selecione o curso</option>

            <!-- pode deixar fixo por enquanto -->
            <option value="1">EXT - MEDICINA</option>
            <option value="2">EXT - ESPECIAL BIOLÓGICAS</option>
            <option value="3">EXT - ESPECIAL HUMANAS</option>
            <option value="4">EXT - ESPECIAL EXATAS</option>
          </select>
          <label>Curso</label>
        </div>

        <div class="divider"></div>

        <div class="actions" style="margin-top:16px;">
          <button class="btn blue darken-2 btn-wide" onclick="abrirListaGeral()">
            <i class="material-icons left">list</i>Lista Geral (Entrada)
          </button>

          <button class="btn green darken-2 btn-wide" onclick="abrirListaSala()">
            <i class="material-icons left">meeting_room</i>Lista por Sala (Porta)
          </button>
        </div>

      </div>
    </div>

    <div style="text-align:center; color:var(--muted); font-size:.9rem; padding:10px 0 18px;">
      Controle de Sala • 3A Sistemas
    </div>

  </div>

<script>
  // ✅ mesmo padrão do seu projeto
  const API = 'https://apisec.secauxiliar.com.br/optativo/';

  document.addEventListener('DOMContentLoaded', () => {
    M.FormSelect.init(document.querySelectorAll('select'));
  });

  function cursoId(){
    const v = document.getElementById('curso').value;
    if(!v){
      M.toast({html:'Selecione um curso'});
      return null;
    }
    return v;
  }

  function abrirListaGeral(){
    const id = cursoId();
    if(!id) return;
    const url = API + 'relatorio_lista_entrada.php?curso_id=' + encodeURIComponent(id);
    window.open(url, '_blank');
  }

  function abrirListaSala(){
    const id = cursoId();
    if(!id) return;
    const url = API + 'relatorio_porta_sala.php?curso_id=' + encodeURIComponent(id);
    window.open(url, '_blank');
  }
</script>

</body>
</html>
